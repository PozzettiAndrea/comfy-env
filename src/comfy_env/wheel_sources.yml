# Wheel sources registry for CUDA packages
#
# Each package has a single wheel_template that resolves to a direct .whl URL.
# Users can override these in their comfy-env.toml [wheel_sources] section.
#
# Template variables:
#   {version}        - Package version (e.g., "0.4.0")
#   {cuda_version}   - Full CUDA version (e.g., "12.8")
#   {cuda_short}     - CUDA without dot (e.g., "128")
#   {cuda_major}     - CUDA major version (e.g., "12")
#   {torch_version}  - Full PyTorch version (e.g., "2.8.0")
#   {torch_short}    - PyTorch without dots (e.g., "280")
#   {torch_mm}       - PyTorch major.minor no dot (e.g., "28")
#   {torch_dotted_mm}- PyTorch major.minor with dot (e.g., "2.8")
#   {py_version}     - Python version (e.g., "3.10")
#   {py_short}       - Python without dot (e.g., "310")
#   {py_minor}       - Python minor version only (e.g., "10")
#   {py_tag}         - Python tag (e.g., "cp310")
#   {platform}       - Platform tag (e.g., "linux_x86_64")

packages:
  # ===========================================================================
  # PyTorch Geometric (PyG) - official wheels
  # https://pytorch-geometric.readthedocs.io/en/latest/install/installation.html
  # ===========================================================================
  torch-scatter:
    wheel_template: "https://data.pyg.org/whl/torch-{torch_version}%2Bcu{cuda_short}/torch_scatter-{version}%2Bpt{torch_mm}cu{cuda_short}-{py_tag}-{py_tag}-{platform}.whl"
    description: Scatter operations for PyTorch

  torch-cluster:
    wheel_template: "https://data.pyg.org/whl/torch-{torch_version}%2Bcu{cuda_short}/torch_cluster-{version}%2Bpt{torch_mm}cu{cuda_short}-{py_tag}-{py_tag}-{platform}.whl"
    description: Clustering algorithms for PyTorch

  torch-sparse:
    wheel_template: "https://data.pyg.org/whl/torch-{torch_version}%2Bcu{cuda_short}/torch_sparse-{version}%2Bpt{torch_mm}cu{cuda_short}-{py_tag}-{py_tag}-{platform}.whl"
    description: Sparse tensor operations for PyTorch

  torch-spline-conv:
    wheel_template: "https://data.pyg.org/whl/torch-{torch_version}%2Bcu{cuda_short}/torch_spline_conv-{version}%2Bpt{torch_mm}cu{cuda_short}-{py_tag}-{py_tag}-{platform}.whl"
    description: Spline convolutions for PyTorch

  # ===========================================================================
  # PozzettiAndrea cuda-wheels (unified PEP 503 index)
  # https://pozzettiandrea.github.io/cuda-wheels
  # ===========================================================================
  pytorch3d:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/pytorch3d/pytorch3d-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    default_version: "0.7.9"
    description: PyTorch3D - 3D deep learning library

  nvdiffrast:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/nvdiffrast/nvdiffrast-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: NVIDIA differentiable rasterizer

  cumesh:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/cumesh/cumesh-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: CUDA-accelerated mesh utilities

  cubvh:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/cubvh/cubvh-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: CUDA BVH acceleration for mesh operations and marching cubes

  o_voxel:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/o-voxel/o_voxel-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: O-Voxel CUDA extension for TRELLIS

  flex_gemm:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/flex-gemm/flex_gemm-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: Flexible GEMM operations

  nvdiffrec_render:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/nvdiffrec-render/nvdiffrec_render-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: NVDiffRec rendering utilities

  gsplat:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/gsplat/gsplat-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: Gaussian splatting rasterization

  cc_torch:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/cc-torch/cc_torch-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: GPU-accelerated connected components

  torch_generic_nms:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/torch-generic-nms/torch_generic_nms-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: GPU-accelerated Non-Maximum Suppression

  lietorch:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/lietorch/lietorch-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: Lie group operations for PyTorch (DPVO dependency)

  dpvo-cuda:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/dpvo_cuda/dpvo_cuda-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    default_version: "1.0.0"
    description: DPVO CUDA extensions (cuda_corr, cuda_ba, lietorch_backends)

  sageattention:
    wheel_template: "https://pozzettiandrea.github.io/cuda-wheels/sageattention/sageattention-{version}%2Bcu{cuda_short}torch{torch_mm}-{py_tag}-{py_tag}-{platform}.whl"
    description: SageAttention - 2-5x faster than FlashAttention with quantized kernels

  # ===========================================================================
  # detectron2 - Facebook's detection library
  # https://github.com/facebookresearch/detectron2
  # Prebuilt wheels from miropsota's torch_packages_builder
  # ===========================================================================
  detectron2:
    wheel_template: "https://miropsota.github.io/torch_packages_builder/detectron2/detectron2-0.6%2B2a420edpt{torch_version}cu{cuda_short}-{py_tag}-{py_tag}-{platform}.whl"
    description: Detectron2 - Facebook's detection and segmentation library

  # ===========================================================================
  # flash-attn - Dao-AILab (Linux x86_64)
  # For other platforms, users should add custom wheel_source in their config
  # ===========================================================================
  flash-attn:
    wheel_template: "https://github.com/Dao-AILab/flash-attention/releases/download/v{version}/flash_attn-{version}%2Bcu{cuda_major}torch{torch_dotted_mm}cxx11abiTRUE-{py_tag}-{py_tag}-linux_x86_64.whl"
    description: Flash Attention for fast transformer inference (Linux x86_64)

  # ===========================================================================
  # spconv - Sparse convolution library
  # PyPI with CUDA-versioned package names (spconv-cu124, spconv-cu126, etc.)
  # Note: This uses a special package_name field, not wheel_template
  # ===========================================================================
  spconv:
    package_name: "spconv-cu{cuda_short2}"
    description: Sparse convolution library (installs spconv-cu124, spconv-cu126, etc.)
